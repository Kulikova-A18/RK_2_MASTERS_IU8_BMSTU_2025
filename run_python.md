# API для системы поддержки (HelpDesk API)

Этот проект представляет собой REST API, разработанное с использованием Flask, для доступа к данным системы поддержки, хранящимся в базе данных PostgreSQL. API предоставляет информацию о пользователях, сотрудниках, тикетах, комментариях и метриках.

## Структура проекта

*   `main.py`: Основной файл Flask-приложения.
*   `requirements.txt`: Файл с зависимостями Python.
*   `logs/`: Папка для хранения логов приложения (создается автоматически).
*   `README.md`: Этот файл.

## Требования

*   **Python 3.x** (рекомендуется 3.8 или выше)
*   **PostgreSQL** (установленный и запущенный)
*   **pip** (менеджер пакетов Python)

## Установка и настройка

1.  **Клонируйте репозиторий (если применимо) или скачайте `main.py`.**

2.  **Создайте и активируйте виртуальное окружение (рекомендуется):**

    ```bash
    python3 -m venv venv
    source venv/bin/activate  # На Windows: venv\Scripts\activate
    ```

3.  **Установите зависимости Python:**

    ```bash
    pip install psycopg2-binary Flask
    ```
    *(Если у вас возникли ошибки при установке `psycopg2-binary`, как описано ранее, установите системные зависимости: `sudo apt install build-essential python3-dev libpq-dev libblas-dev liblapack-dev` и повторите установку через `pip`.)*

4.  **Настройте PostgreSQL:**
    *   Убедитесь, что PostgreSQL запущен: `sudo systemctl start postgresql` (или аналогичная команда для вашего дистрибутива).
    *   Создайте базу данных и заполните её тестовыми данными, используя скрипт `create_support_db.sh` (из вашего репозитория).
    *   Установите пароль для пользователя `postgres`. Подключитесь к PostgreSQL: `sudo -u postgres psql` и выполните команду: `ALTER USER postgres PASSWORD 'your_secure_password';` (замените `'your_secure_password'` на желаемый пароль). Выйдите из `psql`: `\q`.

5.  **Настройте `main.py`:**
    *   Откройте файл `main.py` в текстовом редакторе.
    *   Найдите строку `DB_PASSWORD = 'new_secure_password'`.
    *   Замените `'new_secure_password'` на **пароль, который вы установили для пользователя `postgres` в шаге 4**.
    *   Сохраните изменения в `main.py`.

## Запуск приложения

1.  Убедитесь, что виртуальное окружение активно (если использовали).
2.  Запустите приложение:

    ```bash
    python3 main.py
    ```
    *(Вам **не нужно** запускать скрипт с `sudo`, если вы указали правильный пароль и настроили аутентификацию PostgreSQL для подключения с вашего обычного пользователя Python-скриптом.)*

3.  Приложение будет доступно по адресу: `http://0.0.0.0:5000`

## Логирование

Приложение логирует свои действия в файл `logs/api.log` в текущей директории. Файл лога ротируется, когда его размер превышает 10 КБ.

## Важно

*   Пароль для подключения к PostgreSQL (`DB_PASSWORD` в `main.py`) должен совпадать с паролем, установленным для пользователя `postgres`.
*   Приложение настроено на работу только с GET-запросами. Попытка выполнить POST/PUT/DELETE запросы приведет к ошибке 405.
*   Данные для аутентификации (`USERS_DB`) в коде захардкожены. В продакшен-окружении данные пользователей должны храниться в защищенной таблице в базе данных.