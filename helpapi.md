# HelpDesk API - Документация по запросам через терминал

Этот документ описывает, как выполнять запросы к HelpDesk API с использованием команды `curl` в терминале.

## Общая информация

*   **Базовый URL:** `http://0.0.0.0:5000`
*   **Протокол:** HTTP GET
*   **Формат ответа:** JSON
*   **Аутентификация:** Для большинства эндпоинтов требуется аутентификация с использованием параметров `login` и `code` в строке запроса.

## Аутентификация

Для доступа к защищенным эндпоинтам используйте следующие учетные данные:

| Логин         | Пароль (используется как `code`) |
| :------------ | :------------------------------- |
| `admin`       | `admin123`                       |
| `manager_it`  | `it2024`                         |
| `manager_hr`  | `hr2024`                         |
| `analyst`     | `analyst2024`                    |

Пример строки запроса с аутентификацией:
`curl "http://0.0.0.0:5000/api/v1/profile?login=admin&code=admin123"`

## Доступные эндпоинты

### 1. Проверка состояния API

*   **Эндпоинт:** `GET /api/v1/health`
*   **Аутентификация:** Не требуется
*   **Описание:** Возвращает статус работоспособности API и количество загруженных записей из базы данных.
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/health"
    ```

### 2. Профиль пользователя

*   **Эндпоинт:** `GET /api/v1/profile`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает информацию о профиле аутентифицированного пользователя (роль, количество тикетов и т.д.).
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/profile?login=analyst&code=analyst2024"
    ```

### 3. Отделы

*   **Эндпоинт:** `GET /api/v1/departments`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает статистику по отделам, к которым у пользователя есть доступ.
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/departments?login=manager_it&code=it2024"
    ```

### 4. Тикеты пользователя

*   **Эндпоинт:** `GET /api/v1/tickets`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает список тикетов, назначенных на аутентифицированного сотрудника.
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/tickets?login=analyst&code=analyst2024"
    ```

### 5. Детали тикета

*   **Эндпоинт:** `GET /api/v1/tickets/<int:ticket_id>`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает детальную информацию о конкретном тикете. Пользователь должен иметь права на доступ к этому тикету (обычно быть назначенным сотрудником).
*   **Параметры:**
    *   `ticket_id` (int): Уникальный идентификатор тикета.
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/tickets/1?login=admin&code=admin123"
    ```

### 6. Сотрудники

*   **Эндпоинт:** `GET /api/v1/staff`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает список активных сотрудников, к которым у пользователя есть доступ (на основе его отделов).
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/staff?login=manager_it&code=it2024"
    ```

### 7. Метрики

*   **Эндпоинт:** `GET /api/v1/metrics`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает персональные и отделские метрики для аутентифицированного пользователя.
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/metrics?login=analyst&code=analyst2024"
    ```

### 8. Таймлайн

*   **Эндпоинт:** `GET /api/v1/timeline`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает статистику по тикетам (созданные, решенные) за последние N дней.
*   **Параметры:**
    *   `days` (int, опционально): Количество дней для отображения (по умолчанию 30, максимум 365).
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/timeline?login=analyst&code=analyst2024&days=14"
    ```

### 9. Сравнение

*   **Эндпоинт:** `GET /api/v1/comparison`
*   **Аутентификация:** Требуется
*   **Описание:** Сравнивает производительность аутентифицированного пользователя с его отделом.
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/comparison?login=manager_hr&code=hr2024"
    ```

### 10. Прогноз

*   **Эндпоинт:** `GET /api/v1/forecast`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает прогноз по тикетам и трендовый анализ.
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/forecast?login=admin&code=admin123"
    ```

### 11. Категории

*   **Эндпоинт:** `GET /api/v1/categories`
*   **Аутентификация:** Требуется
*   **Описание:** Возвращает статистику по категориям проблем для аутентифицированного сотрудника.
*   **Пример запроса:**
    ```bash
    curl "http://0.0.0.0:5000/api/v1/categories?login=analyst&code=analyst2024"
    ```
